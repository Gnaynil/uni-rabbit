"use strict";const e=require("../../common/vendor.js"),a=require("../../services/address.js");if(require("../../utils/http.js"),require("../../stores/index.js"),require("../../stores/modules/member.js"),!Array){(e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-forms"))()}Math||((()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-forms-item/uni-forms-item.js")+(()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-forms/uni-forms.js"))();const r={__name:"address-form",props:{id:{type:String,default:""}},setup(r){const o=r;e.index.setNavigationBarTitle({title:o.id?"修改地址":"新建地址"});const t=e.ref({receiver:"",contact:"",fullLocation:"",provinceCode:"",cityCode:"",countyCode:"",address:"",isDefault:0}),i={receiver:{rules:[{required:!0,errorMessage:"请输入收货人姓名"}]},contact:{rules:[{required:!0,errorMessage:"请输入联系方式"},{pattern:/^1[3-9]\d{9}$/,errorMessage:"手机号格式不正确"}]},fullLocation:{rules:[{required:!0,errorMessage:"请选择所在地区"}]},address:{rules:[{required:!0,errorMessage:"请输入详细地址"}]}},s=e.ref(),l=e=>{t.value.provinceCode=e.detail.code[0],t.value.cityCode=e.detail.code[1],t.value.countyCode=e.detail.code[2],t.value.fullLocation=e.detail.value.join(" ")},u=e=>{e.detail.value?t.value.isDefault=1:t.value.isDefault=0},d=async()=>{try{await s.value.validate(),o.id?(await a.putMemberAddressByIdAPI(o.id,t.value),e.index.showToast({title:"修改成功"}),setTimeout((()=>{e.index.navigateBack()}),500)):(await a.postMemberAddressAPI(t.value),e.index.showToast({title:"添加成功"}),setTimeout((()=>{e.index.navigateBack()}),500))}catch(r){e.index.showToast({icon:"error",title:"请填写完整信息"})}};return e.onLoad((()=>(async()=>{const e=await a.getMemberAddressByIdAPI(o.id);t.value=e.result})())),(a,r)=>{var o;return e.e({a:t.value.receiver,b:e.o((e=>t.value.receiver=e.detail.value)),c:e.p({name:"receiver"}),d:t.value.contact,e:e.o((e=>t.value.contact=e.detail.value)),f:e.p({name:"contact"}),g:t.value.fullLocation},t.value.fullLocation?{h:e.t(t.value.fullLocation)}:{},{i:null==(o=t.value.fullLocation)?void 0:o.split(" "),j:e.o(l),k:e.p({name:"fullLocation"}),l:t.value.address,m:e.o((e=>t.value.address=e.detail.value)),n:e.p({name:"address"}),o:e.o(u),p:1===t.value.isDefault,q:e.sr(s,"d8b42f9c-0",{k:"formRef"}),r:e.p({rules:i,model:t.value}),s:e.o(d)})}}};wx.createPage(r);
