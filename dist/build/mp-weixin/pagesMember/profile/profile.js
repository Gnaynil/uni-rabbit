"use strict";const e=require("../../common/vendor.js"),a=require("../../services/profile.js"),o=require("../../stores/modules/member.js");require("../../utils/http.js"),require("../../stores/index.js");const t={__name:"profile",setup(t){const{safeAreaInsets:i}=e.index.getSystemInfoSync(),l=o.useMemberStore(),s=e.ref({});e.onLoad((()=>{(async()=>{const e=await a.getMemberProfileAPI();s.value=e.result})()}));const r=()=>{e.index.chooseMedia({count:1,mediaType:["image"],success:a=>{const{tempFilePath:o}=a.tempFiles[0];e.index.uploadFile({url:"/member/profile/avatar",name:"file",filePath:o,success:a=>{if(200===a.statusCode){const{avatar:o}=JSON.parse(a.data).result;s.value.avatar=o,l.profile.avatar=o,e.index.showToast({icon:"success",title:"更新成功"})}else e.index.showToast({icon:"error",title:"出现错误"})}})}})},n=e=>{s.value.gender=e.detail.value},u=e=>{s.value.birthday=e.detail.value};let c=["","",""];const d=e=>{s.value.fullLocation=e.detail.value.join(" "),c=e.detail.code},v=async()=>{const{nickname:o,gender:t,birthday:i,profession:r}=s.value;console.log(c);let n={};n=c[0]?await a.putMemberProfileAPI({nickname:o,gender:t,birthday:i,profession:r,provinceCode:c[0],cityCode:c[1],countyCode:c[2]}):await a.putMemberProfileAPI({nickname:o,gender:t,birthday:i,profession:r}),l.profile.nickname=n.result.nickname,l.profile.profession=n.result.profession,e.index.showToast({icon:"success",title:"更新成功"}),setTimeout((()=>{e.index.navigateBack()}),500)};return(a,o)=>{var t,l;return e.e({a:(null==(t=e.unref(i))?void 0:t.top)+"px",b:s.value.avatar,c:e.o(r),d:e.t(s.value.account),e:s.value.nickname,f:e.o((e=>s.value.nickname=e.detail.value)),g:"男"===s.value.gender,h:"女"===s.value.gender,i:e.o(n),j:s.value.birthday},s.value.birthday?{k:e.t(s.value.birthday)}:{},{l:new Date,m:s.value.birthday,n:e.o(u),o:s.value.fullLocation},s.value.fullLocation?{p:e.t(s.value.fullLocation)}:{},{q:null==(l=s.value.fullLocation)?void 0:l.split(" "),r:e.o(d),s:s.value.profession,t:e.o((e=>s.value.profession=e.detail.value)),v:e.o(v)})}}};wx.createPage(t);
