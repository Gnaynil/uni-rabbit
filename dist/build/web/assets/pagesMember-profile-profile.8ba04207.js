import{g as e,p as a,l,o as s,c as t,w as o,e as u,a as c,b as n,q as r,f as d,t as i,N as f,y as m,M as p,j as v,i as _,d as h,I as b,O as y,P as k,Q as g,R as C,A as j}from"./index-af18ee11.js";import{h as x}from"./http.84d8a07a.js";import{o as w}from"./uni-app.es.6b8c51ac.js";import{_ as V}from"./_plugin-vue_export-helper.1b428a4d.js";const T=e=>x({method:"PUT",url:"/member/profile",data:e}),L=V({__name:"profile",setup(V){const{safeAreaInsets:L}=e(),P=a(),F=l({}),I=async()=>{const e=await x({method:"GET",url:"/member/profile"});F.value=e.result};w((()=>{I()}));const U=()=>{uni.chooseMedia({count:1,mediaType:["image"],success:e=>{const{tempFilePath:a}=e.tempFiles[0];f({url:"/member/profile/avatar",name:"file",filePath:a,success:e=>{if(200===e.statusCode){const{avatar:a}=JSON.parse(e.data).result;F.value.avatar=a,P.profile.avatar=a,m({icon:"success",title:"更新成功"})}else m({icon:"error",title:"出现错误"})}})}})},A=e=>{F.value.gender=e.detail.value},M=e=>{F.value.birthday=e.detail.value};let N=["","",""];const O=e=>{F.value.fullLocation=e.detail.value.join(" "),N=e.detail.code},q=async()=>{const{nickname:e,gender:a,birthday:l,profession:s}=F.value;console.log(N);let t={};t=N[0]?await T({nickname:e,gender:a,birthday:l,profession:s,provinceCode:N[0],cityCode:N[1],countyCode:N[2]}):await T({nickname:e,gender:a,birthday:l,profession:s}),P.profile.nickname=t.result.nickname,P.profile.profession=t.result.profession,m({icon:"success",title:"更新成功"}),setTimeout((()=>{p()}),500)};return(e,a)=>{const l=v,f=u,m=_,p=h,x=b,w=y,V=k,T=g,P=C,I=j;return s(),t(f,{class:"viewport"},{default:o((()=>{var e;return[c(f,{class:"navbar",style:r({paddingTop:(null==(e=d(L))?void 0:e.top)+"px"})},{default:o((()=>[c(l,{"open-type":"navigateBack",class:"back icon-left","hover-class":"none"}),c(f,{class:"title"},{default:o((()=>[n("个人信息")])),_:1})])),_:1},8,["style"]),c(f,{class:"avatar"},{default:o((()=>[c(f,{class:"avatar-content",onClick:U},{default:o((()=>[c(m,{class:"image",src:F.value.avatar,mode:"aspectFill"},null,8,["src"]),c(p,{class:"text"},{default:o((()=>[n("点击修改头像")])),_:1})])),_:1})])),_:1}),c(f,{class:"form"},{default:o((()=>[c(f,{class:"form-content"},{default:o((()=>[c(f,{class:"form-item"},{default:o((()=>[c(p,{class:"label"},{default:o((()=>[n("账号")])),_:1}),c(p,{class:"account"},{default:o((()=>[n(i(F.value.account),1)])),_:1})])),_:1}),c(f,{class:"form-item"},{default:o((()=>[c(p,{class:"label"},{default:o((()=>[n("昵称")])),_:1}),c(x,{class:"input",type:"text",placeholder:"请填写昵称",modelValue:F.value.nickname,"onUpdate:modelValue":a[0]||(a[0]=e=>F.value.nickname=e)},null,8,["modelValue"])])),_:1}),c(f,{class:"form-item"},{default:o((()=>[c(p,{class:"label"},{default:o((()=>[n("性别")])),_:1}),c(T,{onChange:A},{default:o((()=>[c(V,{class:"radio"},{default:o((()=>[c(w,{value:"男",color:"#27ba9b",checked:"男"===F.value.gender},null,8,["checked"]),n(" 男 ")])),_:1}),c(V,{class:"radio"},{default:o((()=>[c(w,{value:"女",color:"#27ba9b",checked:"女"===F.value.gender},null,8,["checked"]),n(" 女 ")])),_:1})])),_:1})])),_:1}),c(f,{class:"form-item"},{default:o((()=>[c(p,{class:"label"},{default:o((()=>[n("生日")])),_:1}),c(P,{class:"picker",mode:"date",start:"1900-01-01",end:new Date,value:F.value.birthday,onChange:M},{default:o((()=>[F.value.birthday?(s(),t(f,{key:0},{default:o((()=>[n(i(F.value.birthday),1)])),_:1})):(s(),t(f,{key:1,class:"placeholder"},{default:o((()=>[n("请选择日期")])),_:1}))])),_:1},8,["end","value"])])),_:1}),c(f,{class:"form-item"},{default:o((()=>{var e;return[c(p,{class:"label"},{default:o((()=>[n("城市")])),_:1}),c(P,{class:"picker",mode:"region",value:null==(e=F.value.fullLocation)?void 0:e.split(" "),onChange:O},{default:o((()=>[F.value.fullLocation?(s(),t(f,{key:0},{default:o((()=>[n(i(F.value.fullLocation),1)])),_:1})):(s(),t(f,{key:1,class:"placeholder"},{default:o((()=>[n("请选择城市")])),_:1}))])),_:1},8,["value"])]})),_:1}),c(f,{class:"form-item"},{default:o((()=>[c(p,{class:"label"},{default:o((()=>[n("职业")])),_:1}),c(x,{class:"input",type:"text",placeholder:"请填写职业",modelValue:F.value.profession,"onUpdate:modelValue":a[1]||(a[1]=e=>F.value.profession=e)},null,8,["modelValue"])])),_:1})])),_:1}),c(I,{class:"form-button",onClick:q},{default:o((()=>[n("保 存")])),_:1})])),_:1})]})),_:1})}}},[["__scopeId","data-v-a47b4d83"]]);export{L as default};
