import{p as e,l as s,v as a,n as l,o as t,c,w as o,f as u,h as n,F as r,a as d,b as i,r as f,s as p,t as _,x as m,y as v,z as k,d as g,e as x,i as w,j as b,A as h,m as y}from"./index-af18ee11.js";import{_ as C,g as j,d as I,p as V,a as F}from"./cart.5864466a.js";import{a as S,r as T}from"./uni-app.es.6b8c51ac.js";import{_ as G,a as P}from"./uni-swipe-action.ba15f80a.js";import{u as R,_ as U}from"./XtxGuess.5167860d.js";import{_ as X}from"./_plugin-vue_export-helper.1b428a4d.js";const q=X({__name:"CartMain",setup(X){const{guessRef:q,onScrolltolower:z}=R(),A=e(),E=s([]),M=async()=>{const e=await j();E.value=e.result};S((()=>{A.profile&&M()}));const O=async e=>{await V(e.index,{count:e.value})},$=a((()=>E.value.length&&E.value.every((e=>e.selected)))),B=()=>{console.log($.value);const e=!$.value;E.value.forEach((s=>{s.selected=e})),F({selected:e})},D=a((()=>E.value.filter((e=>e.selected)))),H=a((()=>D.value.reduce(((e,s)=>e+s.count),0))),J=a((()=>D.value.reduce(((e,s)=>e+s.count*s.nowPrice),0).toFixed(2))),K=()=>{0===H.value?v({icon:"none",title:"请选择商品"}):k({url:"/pagesOrder/create/create"})};return(e,s)=>{const a=g,k=x,j=w,F=b,S=T(l("vk-data-input-number-box"),C),R=h,X=T(l("uni-swipe-action-item"),G),D=T(l("uni-swipe-action"),P),L=T(l("XtxGuess"),U),N=y;return t(),c(N,{"scroll-y":"",class:"scroll-view",onScrolltolower:u(z)},{default:o((()=>[u(A).profile?(t(),n(r,{key:0},[(t(),c(k,{key:0,class:"cart-list"},{default:o((()=>[d(k,{class:"tips"},{default:o((()=>[d(a,{class:"label"},{default:o((()=>[i("满减")])),_:1}),d(a,{class:"desc"},{default:o((()=>[i("满1件, 即可享受9折优惠")])),_:1})])),_:1}),d(D,null,{default:o((()=>[(t(!0),n(r,null,f(E.value,(e=>(t(),c(X,{key:e.skuId,class:"cart-swipe"},{right:o((()=>[d(k,{class:"cart-swipe-right"},{default:o((()=>[d(R,{class:"button delete-button",onClick:s=>{return a=e.skuId,void m({content:"是否删除",success:async e=>{e.confirm&&(await I({ids:[a]}),v({title:"删除成功"}),setTimeout((()=>{M()}),500))}});var a}},{default:o((()=>[i("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),default:o((()=>[d(k,{class:"goods"},{default:o((()=>[d(a,{class:p(["checkbox",{checked:e.selected}]),onClick:s=>(e=>{e.selected=!e.selected,V(e.skuId,{selected:e.selected})})(e)},null,8,["class","onClick"]),d(F,{url:`/pages/goods/goods?id=${e.id}`,"hover-class":"none",class:"navigator"},{default:o((()=>[d(j,{mode:"aspectFill",class:"picture",src:e.picture},null,8,["src"]),d(k,{class:"meta"},{default:o((()=>[d(k,{class:"name ellipsis"},{default:o((()=>[i(_(e.name),1)])),_:2},1024),d(k,{class:"attrsText ellipsis"},{default:o((()=>[i(_(e.attrsText),1)])),_:2},1024),d(k,{class:"price"},{default:o((()=>[i(_(e.nowPrice),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"]),d(k,{class:"count"},{default:o((()=>[d(S,{modelValue:e.count,"onUpdate:modelValue":s=>e.count=s,min:1,max:e.stock,onChange:O,index:e.skuId},null,8,["modelValue","onUpdate:modelValue","max","index"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})),d(k,{class:"toolbar"},{default:o((()=>[d(a,{class:p(["all",{checked:u($)}]),onClick:B},{default:o((()=>[i("全选")])),_:1},8,["class"]),d(a,{class:"text"},{default:o((()=>[i("合计:")])),_:1}),d(a,{class:"amount"},{default:o((()=>[i(_(u(J)),1)])),_:1}),d(k,{class:"button-grounp"},{default:o((()=>[d(k,{onClick:K,class:p(["button payment-button",{disabled:0===u(H)}])},{default:o((()=>[i(" 去结算("+_(u(H))+") ",1)])),_:1},8,["class"])])),_:1})])),_:1})],64)):(t(),c(k,{key:1,class:"login-blank"},{default:o((()=>[d(a,{class:"text"},{default:o((()=>[i("登录后可查看购物车中的商品")])),_:1}),d(F,{url:"/pages/login/login","hover-class":"none"},{default:o((()=>[d(R,{class:"button"},{default:o((()=>[i("去登录")])),_:1})])),_:1})])),_:1})),d(L,{ref_key:"guessRef",ref:q,class:"guess"},null,512)])),_:1},8,["onScrolltolower"])}}},[["__scopeId","data-v-4457418c"]]);export{q as C};
